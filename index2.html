<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Korea Bike Trip - Interactive Zine</title>

    <!-- Import the scrolly-video library -->
    <script src="https://cdn.jsdelivr.net/npm/scrolly-video@latest/dist/scrolly-video.js"></script>
    
    <!-- External stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="nav-tabs">
                <button class="nav-tab active" data-section="prep">PREP</button>
                <button class="nav-tab" data-section="journey">JOURNEY</button>
                <button class="nav-tab" data-section="photos">PHOTOS</button>
                <button class="nav-tab" data-section="videos">VIDEOS</button>
            </div>
        </div>
    </nav>

    <!-- PREP SECTION -->
    <section id="prep-section" class="main-section active">
        <!-- Opening page with bike image -->
    <div class="opening-page">
        <div class="bike-image-container">
            <img src="pages/krzineCover1.jpg" alt="Biking Korea" class="bike-image">
        </div>
        <div class="scroll-indicator">
            <div class="scroll-arrow">â†“</div>
        </div>
    </div>

    <!-- Left Page (p1) - Layered page section structured like the video sections -->
    <div class="scrolly-container layered-page-section" id="p1-section">
        <!-- Layered image sticky container -->
        <div id="layered-section">
            <div class="layered-container">
                <!-- Base layer (always visible) -->
                <img src="pages/p1/p1_1.jpg" alt="Page 1 Layer 1" class="layer-image base-layer">
                
                <!-- Additional layers that appear on scroll -->
                <img src="pages/p1/p1_2.png" alt="Page 1 Layer 2" class="layer-image scroll-layer" data-layer="2">
                <img src="pages/p1/p1_3.png" alt="Page 1 Layer 3" class="layer-image scroll-layer" data-layer="3">
                <img src="pages/p1/p1_4.png" alt="Page 1 Layer 4" class="layer-image scroll-layer" data-layer="4">
                <img src="pages/p1/p1_5.png" alt="Page 1 Layer 5" class="layer-image scroll-layer" data-layer="5">
            </div>
        </div>
        
        <!-- Empty div to create scroll space for layered effect -->
        <div class="scroll-space"></div>
    </div>
    
    <!-- Right Page (p2) - Layered page section structured like the video sections -->
    <div class="scrolly-container layered-page-section" id="p2-section">
        <!-- Layered image sticky container -->
        <div id="layered-section-2">
            <div class="layered-container">
                <!-- Base layer (always visible) -->
                <img src="pages/p2/p2_1.jpg" alt="Page 2 Layer 1" class="layer-image base-layer">
                
                <!-- Additional layers that appear on scroll -->
                <img src="pages/p2/p2_2.png" alt="Page 2 Layer 2" class="layer-image scroll-layer" data-layer="2">
                <img src="pages/p2/p2_3.png" alt="Page 2 Layer 3" class="layer-image scroll-layer" data-layer="3">
                <img src="pages/p2/p2_4.png" alt="Page 2 Layer 4" class="layer-image scroll-layer" data-layer="4">
                <img src="pages/p2/p2_5.png" alt="Page 2 Layer 5" class="layer-image scroll-layer" data-layer="5">
            </div>
        </div>
        
        <!-- Empty div to create scroll space for layered effect -->
        <div class="scroll-space"></div>
    </div>
    
    <!-- P3 Page - Interactive Bike Setup -->
    <div class="interactive-page-section" id="p3-section">
        <!-- SVG container for curved lines -->
        <svg class="curve-container" id="curve-svg">
        </svg>
        
        <div class="interactive-container">
            <!-- Base bike image with hotspots -->
            <div class="image-wrapper">
                <img src="pages/p3/pck1.jpg" alt="Bike Setup" class="interactive-bike-image">
                
                <!-- Interactive hotspots -->
            <div class="hotspot" data-label="jack" style="top: 67%; left: 26%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Jack The Rack<br>(It's a tiny front rack<br>that mounts onto<br>the handlebars.<br>I was amazed how<br>well it held up!)</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="ile-porteur" style="top: 71%; left: 8%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Front rack bag:<br>ILE Porteur Bag- Medium</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="pizza-rat" style="top: 64%; left: 8%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">PIZZA RAT</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="cargo-net" style="top: 59%; left: 13%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Cargo net:<br>invaluable!</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="phone-mount" style="top: 59%; left: 22%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Phone Mount:<br>Peak Design Out Front mount</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="navigation" style="top: 59%; left: 31%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Navigation:<br>Wahoo Hammerhead Karoo 2</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="speaker" style="top: 64%; left: 40%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Speaker:<br>Tribit Stormbox 2</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="revelate" style="top: 69%; left: 45%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Revelate Designs<br>Tangle Half Frame bag:<br>Worked great!, but gets in<br>the way of the bottles, NBD</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="lights" style="top: 66%; left: 64%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Regular lights:<br>For front lights,<br>get one that you<br>can slide on and off.<br>Straps break, like<br>mine did.</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="ral" style="top: 75%; left: 72%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Rear rack- RAL Ex-Loader:<br>Good size! But actually fell<br>off while riding, and had to<br>go back and pick it up.</div>
                    <div class="label-line"></div>
                </div>
            </div>
            
            <div class="hotspot" data-label="simworks" style="top: 66%; left: 77%;">
                <div class="hotspot-dot"></div>
                <div class="hotspot-label">
                    <div class="label-text">Simworks by Nitto:<br>On The Road Rack</div>
                    <div class="label-line"></div>
                </div>
            </div>
            </div>
        </div>
    </div>
    
    <!-- P4 Page - Static tall image -->
    <div class="static-page-section" id="p4-section">
        <div class="static-container">
            <img src="pages/p4/p4tall.jpg" alt="Page 4" class="static-tall-image">
        </div>
    </div>
    
    <!-- P5 Page - Static image -->
    <div class="regular-page-section" id="p5-section">
        <div class="regular-container">
            <img src="pages/p5/p5.jpg" alt="Page 5" class="static-image">
        </div>
    </div>
    
    <!-- P6 Page - Static image -->
    <div class="regular-page-section" id="p6-section">
        <div class="regular-container">
            <img src="pages/p6/p6.jpg" alt="Page 6" class="static-image">
        </div>
    </div>
    
    <!-- P7 Page - Base and cover images -->
    <div class="regular-page-section" id="p7-section">
        <div class="regular-container">
            <div class="xray-container">
                <!-- Base layer - packed bike image -->
                <img src="pages/p7/p7_1.jpg" alt="Packed Bike Base" class="xray-base-image">
                <!-- Cover layer - cardboard box overlay -->
                <img src="pages/p7/p7_2.png" alt="Cardboard Box Cover" class="xray-cover-image">
                
                <!-- P7 Interactive labels that appear on X-ray reveal -->
                <div class="p7-label" data-item="rear-rack" style="top: 25%; left: 72%;">
                    <img src="pages/p7/rack-line.svg" alt="Rear rack marker" class="p7-marker">
                    <div class="p7-label-text">REAR RACK<br>STAYED ON<br>BIKE SHOP</div>
                </div>
                
                <div class="p7-label" data-item="handlebar" style="top: 32%; left: 27%;">
                    <img src="pages/p7/bar-line.svg" alt="Handlebar marker" class="p7-marker">
                    <div class="p7-label-text">HANDLEBAR<br>OFF</div>
                </div>
                
                <div class="p7-label" data-item="seat-post" style="top: 45%; left: 45%;">
                    <img src="pages/p7/seat-line.svg" alt="Seat post marker" class="p7-marker">
                    <div class="p7-label-text">SEAT POST<br>OFF</div>
                </div>
                
                <div class="p7-label" data-item="pedals" style="top: 55%; left: 35%;">
                    <img src="pages/p7/pedal-line.svg" alt="Pedals marker" class="p7-marker">
                    <div class="p7-label-text">PEDALS<br>BUBBLE WRAPPED<br>(DIDN'T NEED TO<br>UNSCREW THEM!)</div>
                </div>
                
                <div class="p7-label" data-item="derailleur" style="top: 60%; left: 65%;">
                    <img src="pages/p7/derailer-line.svg" alt="Derailleur marker" class="p7-marker">
                    <div class="p7-label-text">DERAILLEUR<br>PROTECTED<br>AND BUBBLE<br>WRAPPED</div>
                </div>
                
                <div class="p7-label" data-item="bottle-cages" style="top: 50%; left: 55%;">
                    <img src="pages/p7/cage-line.svg" alt="Bottle cages marker" class="p7-marker">
                    <div class="p7-label-text">BOTTLE<br>CAGES:<br>BUBBLE<br>WRAPPED</div>
                </div>
                
                <div class="p7-label" data-item="thru-axle" style="top: 65%; left: 50%;">
                    <img src="pages/p7/axle-line.svg" alt="Thru-axle marker" class="p7-marker">
                    <div class="p7-label-text">THRU-AXLE<br>STAYS ON<br>BIKE, PROTECT<br>THE FORK</div>
                </div>
                
                <div class="p7-label" data-item="cardboard-box" style="top: 15%; left: 15%;">
                    <img src="pages/p7/box-line.svg" alt="Cardboard box marker" class="p7-marker">
                    <div class="p7-label-text">CARDBOARD BOX<br>FROM LOCAL<br>BIKE SHOP</div>
                </div>
            </div>
        </div>
    </div>
        
        <!-- Additional zine pages will go here -->
        <!-- Add krzine+page1_2_2, krzine+page3_4, etc. -->
        
    </section>
    
    <!-- JOURNEY SECTION -->
    <section id="journey-section" class="main-section">
        <!-- Text section after layered section -->
    <div class="text-section">
        <div class="text-content">
            <h2>Day 1: Guri to Yeoju</h2>
            <p>This is where you can write about the beginning of your journey. Describe the excitement of starting the trip, the weather, your feelings, or any interesting encounters from the first day.</p>
            <p>You can add multiple paragraphs here to tell the full story of your first day on the road. Include details about the route, the scenery, the challenges, and the highlights.</p>
        </div>
    </div>

        <div class="text-section">
            <div class="text-content">
                <h2>Reflections on Day 1</h2>
                <p>Here you can write about your thoughts after completing the first day. What surprised you? What was easier or harder than expected? Any memorable moments or lessons learned?</p>
                <p>This is also a good place to mention any gear that worked well or didn't work as expected, or any adjustments you made to your setup.</p>
            </div>
        </div>

        <div class="text-section">
            <div class="text-content">
                <h2>Day 2: Yeoju to Chungju</h2>
                <p>Write about your second day here. Describe the morning routine, the new challenges you faced, and how the journey is progressing.</p>
                <p>Include details about the landscape changes, any interesting towns you passed through, or encounters with locals.</p>
            </div>
        </div>

        <div class="text-section">
            <div class="text-content">
                <h2>Day 2 Reflections</h2>
                <p>Reflect on the second day of your journey. How are you adapting to the routine? Any new insights about yourself or the trip?</p>
            </div>
        </div>

        <!-- Main container for the scrolly experience -->
        <div class="scrolly-container">
            <!-- Video container -->
            <div id="scrolly-video"></div>
            <!-- Empty div to create scroll space -->
            <div class="scroll-space"></div>
        </div>

        <!-- Second video section -->
        <div class="scrolly-container">
            <!-- Video container -->
            <div id="scrolly-video-2"></div>
            <!-- Empty div to create scroll space -->
            <div class="scroll-space"></div>
        </div>
    </section>
    
    <!-- PHOTOS SECTION -->
    <section id="photos-section" class="main-section">
        <div class="text-section">
            <div class="text-content">
                <h2>Photo Gallery</h2>
                <p>Photos from the journey will go here.</p>
            </div>
        </div>
    </section>
    
    <!-- VIDEOS SECTION -->
    <section id="videos-section" class="main-section">
        <div class="text-section">
            <div class="text-content">
                <h2>Video Collection</h2>
                <p>Additional video content will go here.</p>
            </div>
        </div>
    </section>

    <script>
        // Navigation functionality
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.main-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section
            const selectedSection = document.getElementById(sectionName + '-section');
            if (selectedSection) {
                selectedSection.classList.add('active');
            }
            
            // Add active class to selected tab
            const selectedTab = document.querySelector(`[data-section="${sectionName}"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // Re-initialize scrolly videos if we're in the journey section
            if (sectionName === 'journey') {
                setTimeout(initializeScrollyVideos, 100);
            }
        }
        
        // Add click listeners to nav tabs
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    showSection(section);
                });
            });
            
            // Initialize videos on page load
            initializeScrollyVideos();
        });
        
        // Mobile scroll dampening
        let lastScrollTime = 0;
        let scrollVelocity = 0;
        let dampedScrollY = window.scrollY;
        
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   ('ontouchstart' in window) || 
                   (navigator.maxTouchPoints > 0);
        }
        
        function initializeMobileScrollDampening() {
            if (!isMobileDevice()) return;
            
            let isScrolling = false;
            const dampingFactor = 0.15; // Reduce scroll sensitivity by 85%
            
            function handleTouchMove(e) {
                isScrolling = true;
            }
            
            function handleTouchEnd(e) {
                isScrolling = false;
            }
            
            function handleScroll(e) {
                if (!isScrolling) return;
                
                const now = Date.now();
                const deltaTime = now - lastScrollTime;
                
                if (deltaTime > 0) {
                    const currentScrollY = window.scrollY;
                    const scrollDelta = currentScrollY - dampedScrollY;
                    
                    // Apply dampening only if scroll delta is large (flick gesture)
                    if (Math.abs(scrollDelta) > 30) {
                        scrollVelocity = scrollDelta * dampingFactor;
                        dampedScrollY += scrollVelocity;
                        
                        // Smooth the scroll position
                        window.scrollTo({
                            top: dampedScrollY,
                            behavior: 'auto'
                        });
                    } else {
                        dampedScrollY = currentScrollY;
                    }
                }
                
                lastScrollTime = now;
            }
            
            // Add touch event listeners
            document.addEventListener('touchmove', handleTouchMove, { passive: true });
            document.addEventListener('touchend', handleTouchEnd, { passive: true });
            window.addEventListener('scroll', handleScroll, { passive: true });
        }

        function initializeScrollyVideos() {
            // Clear existing instances
            if (window.scrollyVideo1) window.scrollyVideo1.destroy?.();
            if (window.scrollyVideo2) window.scrollyVideo2.destroy?.();
            
            // Mobile-specific configuration
            const isMobile = isMobileDevice();
            const mobileConfig = isMobile ? {
                transitionSpeed: 0.3, // Even slower transitions on mobile
                frameThreshold: 0.03, // Very sensitive frame changes
            } : {
                transitionSpeed: 1,
                frameThreshold: 0.1,
            };
            
            // Initialize the first ScrollyVideo
            window.scrollyVideo1 = new ScrollyVideo({
                scrollyVideoContainer: "scrolly-video",
                src: "video/day1_1.mp4",
                ...mobileConfig,
                useWebCodecs: true,
                trackScroll: true,
                lockScroll: false,
                debug: true,
                objectFit: "contain"
            });

            // Initialize the second ScrollyVideo
            window.scrollyVideo2 = new ScrollyVideo({
                scrollyVideoContainer: "scrolly-video-2",
                src: "video/day2_1.mp4",
                ...mobileConfig,
                useWebCodecs: true,
                trackScroll: true,
                lockScroll: false,
                debug: true,
                objectFit: "contain"
            });
            
            // Initialize mobile scroll dampening
            initializeMobileScrollDampening();
        }

        // Enhanced scroll effect for layered images that mimics ScrollyVideo behavior
        function handleLayeredSectionScroll(sectionId, layeredSectionId) {
            const layeredPageSection = document.getElementById(sectionId);
            const layeredSection = document.getElementById(layeredSectionId);
            if (!layeredPageSection || !layeredSection) return;
            
            const scrollLayers = layeredSection.querySelectorAll('.scroll-layer');
            
            // Get the scroll space within the layered section
            const scrollSpace = layeredPageSection.querySelector('.scroll-space');
            if (!scrollSpace) return;
            
            // Calculate scroll progress based on position in the section
            const sectionTop = layeredPageSection.offsetTop;
            const sectionHeight = scrollSpace.offsetHeight + window.innerHeight; // Total scrollable height
            const scrollTop = window.pageYOffset;
            
            // Calculate how far we've scrolled through the section
            const scrollPosition = Math.max(0, scrollTop - sectionTop);
            const scrollProgress = Math.min(1, scrollPosition / (sectionHeight - window.innerHeight));
            
            // Calculate which layers should be visible
            const totalLayers = scrollLayers.length;
            
            scrollLayers.forEach((layer, index) => {
                // Start at 20% and distribute layers from 20% to 70% (leaving 30% for sticky final image)
                const layerThreshold = index === 0 ? 0.2 : 0.2 + (0.5 * (index) / (totalLayers - 1));
                
                if (scrollProgress >= layerThreshold) {
                    layer.classList.add('visible');
                } else {
                    layer.classList.remove('visible');
                }
            });
        }
        
        window.addEventListener('scroll', function() {
            // Handle first layered section (p1)
            handleLayeredSectionScroll('p1-section', 'layered-section');
            
            // Handle second layered section (p2)
            handleLayeredSectionScroll('p2-section', 'layered-section-2');
        });

        // Interactive Bike Setup Hotspot functionality
        function initializeHotspots() {
            const hotspots = document.querySelectorAll('.hotspot');
            const curveSvg = document.getElementById('curve-svg');
            
            // Create curves for each hotspot
            hotspots.forEach((hotspot, index) => {
                const curve = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                curve.classList.add('curve-line');
                curve.setAttribute('id', `curve-${index}`);
                curveSvg.appendChild(curve);
                
                const showCurve = () => {
                    const dot = hotspot.querySelector('.hotspot-dot');
                    const label = hotspot.querySelector('.hotspot-label');
                    
                    if (!dot || !label) return;
                    
                    const dotRect = dot.getBoundingClientRect();
                    const labelRect = label.getBoundingClientRect();
                    
                    // Get center of dot
                    const dotX = dotRect.left + dotRect.width / 2;
                    const dotY = dotRect.top + dotRect.height / 2;
                    
                    // Get center bottom of label
                    const labelX = labelRect.left + labelRect.width / 2;
                    const labelY = labelRect.bottom;
                    
                    // Create curved path
                    const midY = (dotY + labelY) / 2;
                    const controlOffset = Math.abs(dotX - labelX) * 0.3;
                    
                    const pathData = `M ${dotX} ${dotY} Q ${dotX < labelX ? dotX + controlOffset : dotX - controlOffset} ${midY} ${labelX} ${labelY}`;
                    
                    curve.setAttribute('d', pathData);
                    curve.style.opacity = '1';
                };
                
                const hideCurve = () => {
                    curve.style.opacity = '0';
                };
                
                // Mobile touch events
                hotspot.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    // Hide all curves first
                    document.querySelectorAll('.curve-line').forEach(c => c.style.opacity = '0');
                    // Remove any existing active states
                    hotspots.forEach(h => h.classList.remove('active'));
                    // Add active state to touched hotspot
                    this.classList.add('active');
                    setTimeout(showCurve, 10);
                }, { passive: false });
                
                hotspot.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    // Remove active state when touch ends, but keep line visible
                    setTimeout(() => {
                        this.classList.remove('active');
                        // Don't hide curve here - let it hide when tooltip disappears
                    }, 150);
                }, { passive: false });
                
                // Desktop mouse events
                hotspot.addEventListener('mouseenter', function() {
                    // Hide all curves first
                    document.querySelectorAll('.curve-line').forEach(c => c.style.opacity = '0');
                    // Remove any existing active states from other hotspots
                    hotspots.forEach(h => {
                        if (h !== this) h.classList.remove('active');
                    });
                    this.classList.add('active');
                    setTimeout(showCurve, 10);
                });
                
                hotspot.addEventListener('mouseleave', function() {
                    this.classList.remove('active');
                    hideCurve();
                });
                
                // Handle clicks for accessibility
                hotspot.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                });
            });
            
            // Close any active hotspots when clicking elsewhere
            document.addEventListener('touchstart', function(e) {
                if (!e.target.closest('.hotspot')) {
                    hotspots.forEach(h => h.classList.remove('active'));
                    // Hide all curves when touching elsewhere
                    document.querySelectorAll('.curve-line').forEach(c => c.style.opacity = '0');
                }
            });
        }
        
        // Initialize hotspots when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeHotspots();
            initializeXrayReveal();
        });
        
        // X-ray reveal effect for P7 with CSS mask and proximity labels
        function initializeXrayReveal() {
            const coverImage = document.querySelector('.xray-cover-image');
            const container = document.querySelector('#p7-section .xray-container');
            const labels = document.querySelectorAll('.p7-label');
            
            if (!coverImage || !container) return;
            
            function updateMaskPosition(x, y) {
                const rect = container.getBoundingClientRect();
                const xPercent = ((x - rect.left) / rect.width) * 100;
                const yPercent = ((y - rect.top) / rect.height) * 100;
                
                coverImage.style.setProperty('--mask-x', `${Math.max(0, Math.min(100, xPercent))}%`);
                coverImage.style.setProperty('--mask-y', `${Math.max(0, Math.min(100, yPercent))}%`);
                
                // Check proximity to labels and show/hide them
                labels.forEach(label => {
                    const labelRect = label.getBoundingClientRect();
                    const labelCenterX = labelRect.left + labelRect.width / 2;
                    const labelCenterY = labelRect.top + labelRect.height / 2;
                    
                    // Calculate distance from cursor to label center
                    const distance = Math.sqrt(
                        Math.pow(x - labelCenterX, 2) + Math.pow(y - labelCenterY, 2)
                    );
                    
                    // Show label if cursor is within 100px
                    if (distance < 100) {
                        label.classList.add('visible');
                    } else {
                        label.classList.remove('visible');
                    }
                });
            }
            
            // Mouse events for desktop
            container.addEventListener('mousemove', function(e) {
                updateMaskPosition(e.clientX, e.clientY);
            });
            
            // Touch events for mobile
            container.addEventListener('touchmove', function(e) {
                e.preventDefault();
                const touch = e.touches[0];
                updateMaskPosition(touch.clientX, touch.clientY);
            }, { passive: false });
            
            container.addEventListener('touchstart', function(e) {
                e.preventDefault();
                const touch = e.touches[0];
                updateMaskPosition(touch.clientX, touch.clientY);
            }, { passive: false });
        }
    </script>

</body>
</html>